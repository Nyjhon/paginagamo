import{o as i,c as h,w as s,a as l,b6 as u,e as n,t as d,q as c,Z as b,g as v,h as k,bd as C,l as y,k as x,p,Q as w}from"./index.60323709.js";import{Q as D}from"./QTree.6536008d.js";import{Q as T,a as _}from"./QTable.17c40189.js";import{Q}from"./QPageContainer.5c057f91.js";import{Q as F}from"./QLayout.e0e42f02.js";import{_ as I}from"./plugin-vue_export-helper.21dcd24c.js";import"./QSlideTransition.a3129178.js";import"./QList.9166df1a.js";import"./QChip.a8ddf73a.js";import"./selection.880541e6.js";import"./format.8ac60962.js";import"./use-fullscreen.ccad7cbe.js";const N={props:["id"],data(){return{mostrarTitulo:!1,categoria:{titulo:null},folders:[],documentos:[],selectedNodeId:null,expanded:[],search:"",filter:"",columns:[{name:"titulo",label:"TITULO",field:"titulo",align:"left"},{name:"contenido",label:"CONTENIDO",field:"contenido",align:"left"},{name:"fecha",label:"FECHA DE PUBLICACI\xD3N",field:"fecha",sortable:!0,align:"left"},{name:"archivo",label:"ENLACE",field:"archivo"}],selectedFolderId:null,folderUnico:null,ruta:"",table:!1,expandedRows:{}}},mounted(){this.mostrarTitulo=!0,this.cargarDocumentos(this.id)},computed:{filteredRows(){if(!this.filter)return this.documentos;const o=this.filter.toLowerCase();return this.documentos.filter(e=>Object.values(e).some(a=>String(a).toLowerCase().includes(o)))}},methods:{previewFile(o){this.$q.loading.show({message:"Cargando archivo..."}),this.$api.get(`/ver-documento/${o}`,{responseType:"blob"}).then(e=>{const a=new Blob([e.data],{type:e.headers["content-type"]}),f=URL.createObjectURL(a);window.open(f,"_blank")}).catch(e=>{this.$q.notify({type:"negative",message:"No se pudo abrir el documento."}),console.error(e)}).finally(()=>{this.$q.loading.hide()})},formatDate(o){if(!o)return"";const e=new Date(o),a=String(e.getDate()).padStart(2,"0"),f=String(e.getMonth()+1).padStart(2,"0"),r=e.getFullYear();return`${a}/${f}/${r}`},clearFilter(){this.filter=""},cargarDocumentos(o){this.$api.get("/documentospagina/"+o).then(e=>{console.log(e.data),this.categoria=e.data.categoria,this.folders=e.data.folders})},handleNodeClick(o){const e=o.node.id;this.selectedFolderId=e,typeof o.expand=="function"&&o.expand(),this.onSelectFolder(e)},onSelectFolder(o){!o||(this.clearFilter(),this.$q.loading.show({message:"Cargando documentos...",spinnerColor:"primary"}),this.$api.get("/documentospaginafolders/"+o).then(e=>{this.documentos=e.data.documentos,this.folderUnico=e.data.folder,this.ruta=e.data.ruta,this.table=!0,this.$nextTick(()=>{setTimeout(()=>{var a;this.$refs.contenedorPagina.scrollTop=this.$refs.tablaDocumentos.offsetTop,(a=this.$refs.tablaDocumentos)==null||a.scrollIntoView({behavior:"smooth",block:"start"})},100)})}).catch(e=>{console.error(e),this.$q.notify({type:"negative",message:"Ocurri\xF3 un error al cargar los documentos"})}).finally(()=>{this.$q.loading.hide()}))},filteredDocumentos(o){if(!this.search)return this.documentos[o]||[];const e=this.search.toLowerCase();return(this.documentos[o]||[]).filter(a=>a.titulo.toLowerCase().includes(e))}}},V={key:0},q={class:"text-h3 text-white text-bold text-uppercase"},L={class:"row q-col-gutter-md"},R={class:"col-12 col-md-4"},$=["onClick"],B={key:0,class:"col-12 col-md-8",ref:"tablaDocumentos"},S={key:0,class:"text-bold"},z={class:"text-bold",style:{"font-size":"1.3em"}},U={style:{"font-size":"1.0em"},class:"text-justify"},E={key:0},O={key:1},P={key:0},j={style:{"font-size":"1.1em"}};function A(o,e,a,f,r,m){return i(),h(F,{view:"hHh LpR fFf"},{default:s(()=>[l(b,{name:"slide-fade",class:"q-pa-xl",style:{"background-color":"#5d0004"}},{default:s(()=>[r.mostrarTitulo?(i(),u("div",V,[n("div",q,d(this.categoria.titulo),1),e[1]||(e[1]=n("hr",null,null,-1))])):c("",!0)]),_:1}),l(Q,{style:{padding:"20px"},ref:"contenedorPagina"},{default:s(()=>[l(v,null,{default:s(()=>[l(k,null,{default:s(()=>[n("div",L,[n("div",R,[l(D,{nodes:r.folders,"node-key":"id","label-key":"nombre","children-key":"children_recursive","default-expand-all":""},{"default-header":s(t=>[n("div",{class:C(["row items-center no-wrap q-gutter-sm full-width cursor-pointer",{"bg-blue-1 text-primary":r.selectedFolderId===t.node.id}]),onClick:g=>m.handleNodeClick(t)},[l(y,{name:"folder",class:"q-mr-sm",color:"secondary",style:{"font-size":"40px"}}),n("div",null,d(t.node.nombre),1)],10,$)]),_:1},8,["nodes"])]),r.table?(i(),u("div",B,[this.ruta?(i(),u("div",S,d(this.ruta),1)):c("",!0),l(T,{rows:m.filteredRows,columns:r.columns,"row-key":"id",flat:"",bordered:"","rows-per-page-options":[10,20,50,100,500]},{"top-right":s(()=>[l(x,{outlined:"","bottom-slots":"",dense:"",debounce:"250",modelValue:r.filter,"onUpdate:modelValue":e[0]||(e[0]=t=>r.filter=t),placeholder:"Buscar"},{append:s(()=>[r.filter!==""?(i(),h(y,{key:0,name:"close",onClick:m.clearFilter,class:"cursor-pointer"},null,8,["onClick"])):c("",!0),l(y,{name:"search"})]),_:1},8,["modelValue"])]),"body-cell-titulo":s(t=>[l(_,{props:t,style:{"white-space":"normal"}},{default:s(()=>[n("div",z,d(t.row.titulo),1)]),_:2},1032,["props"])]),"body-cell-contenido":s(t=>[l(_,{props:t,style:{"white-space":"normal"}},{default:s(()=>[n("div",U,[r.expandedRows[t.row.id]?(i(),u("span",E,[p(d(t.row.contenido)+" ",1),l(w,{flat:"",dense:"",size:"sm",color:"primary",onClick:g=>r.expandedRows[t.row.id]=!1},{default:s(()=>e[2]||(e[2]=[p(" Ver menos ")])),_:2},1032,["onClick"])])):(i(),u("span",O,[p(d(t.row.contenido.substring(0,250)),1),t.row.contenido.length>250?(i(),u("span",P,"...")):c("",!0),t.row.contenido.length>250?(i(),h(w,{key:1,flat:"",dense:"",size:"sm",color:"primary",onClick:g=>r.expandedRows[t.row.id]=!0},{default:s(()=>e[3]||(e[3]=[p(" Ver m\xE1s ")])),_:2},1032,["onClick"])):c("",!0)]))])]),_:2},1032,["props"])]),"body-cell-fecha":s(t=>[l(_,{props:t,style:{"white-space":"normal"}},{default:s(()=>[n("div",j,d(m.formatDate(t.row.fecha)),1)]),_:2},1032,["props"])]),"body-cell-archivo":s(t=>[l(_,{props:t},{default:s(()=>[t.row.archivo?(i(),h(w,{key:0,round:"",dense:"",flat:"",icon:"visibility",color:"primary",onClick:g=>m.previewFile(t.row.id),label:"Descargar"},null,8,["onClick"])):c("",!0)]),_:2},1032,["props"])]),_:1},8,["rows","columns"])],512)):c("",!0)])]),_:1})]),_:1})]),_:1},512)]),_:1})}var se=I(N,[["render",A],["__scopeId","data-v-7d8ccd74"]]);export{se as default};
