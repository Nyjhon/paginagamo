import{o as d,c as g,w as i,a as t,h as n,e as o,i as V,m as y,Q as u,g as m,b6 as h,b7 as C,b8 as E,p as f,k as p,l as _,q as v,b9 as D,f as w,t as k}from"./index.60323709.js";import{Q as x}from"./QImg.22d5224a.js";import{Q}from"./QFile.62787755.js";import{Q as U}from"./QForm.16a89fc1.js";import{Q as S}from"./QPage.f120dced.js";import{d as N}from"./date.ea5ee918.js";import{_ as P}from"./plugin-vue_export-helper.21dcd24c.js";import"./QChip.a8ddf73a.js";import"./format.8ac60962.js";const{formatDate:q}=N,I={data(){return{dialogventanaadd:!1,docData:{titulo:"",descripcion:"",fecha:q(Date.now(),"YYYY-MM-DD"),visible:!0},archivo:null,img:null,imagePreview:null,popup:[]}},created(){this.miventanas()},methods:{onImageSelected(l){const e=l.target.files[0];e&&(this.img=e,this.imagePreview=URL.createObjectURL(e))},Crearventana(){this.$q.dialog({title:"Confirmaci\xF3n",message:"\xBFEst\xE1 seguro de crear el registro?",ok:{push:!0},cancel:{push:!0,color:"negative"},persistent:!0}).onOk(()=>{const l=new FormData;l.append("titulo",this.docData.titulo),l.append("descripcion",this.docData.descripcion),l.append("fecha",this.docData.fecha),l.append("visible",this.docData.visible?"1":"0"),this.img&&l.append("img",this.img),this.archivo&&l.append("archivo",this.archivo),this.$q.loading.show(),this.$api.post("crearventana",l,{headers:{"Content-Type":"multipart/form-data"}}).then(e=>{console.log(e.data),this.$q.loading.hide(),this.docData={titulo:"",descripcion:"",fecha:q(Date.now(),"YYYY-MM-DD"),visible:!0},this.archivo=null,this.img=null,this.dialogventanaadd=!1,this.$q.notify({message:"Ventana Emergente creado Correctamente",type:"positive"}),this.miventanas()}).catch(e=>{console.error("Error al crear:",e)})})},miventanas(){this.$api.get("misventanas").then(l=>{this.popup=l.data,console.log(this.popup)})},getPdfUrl(l){return l?`http://192.168.154.233:81${l}`:""},Eliminar(l){this.$q.dialog({title:"Confirmar",message:"\xBFEst\xE1 seguro de eliminar esta ventana?",cancel:!0,persistent:!0}).onOk(()=>{this.$api.post("eliminarventana",{datos:l}).then(e=>{this.popup=this.popup.filter(c=>c.id!==l.id),this.$q.notify({message:"Ventana eliminada correctamente",type:"negative"})}).catch(e=>{this.$q.notify({message:"Error al eliminar la ventana",type:"warning"})})})},confirmarCambioEstado(l,e){this.$q.dialog({title:"Confirmar",message:"\xBFEst\xE1 seguro de cambiar el estado de visibilidad?",cancel:!0,persistent:!0}).onOk(()=>{this.$api.post("cambiarEstadoVentana",{id:l.id,visible:e}).then(c=>{this.$q.notify({message:"Estado actualizado correctamente",type:"positive"}),l.visible=e}).catch(c=>{this.$q.notify({message:"Error al actualizar estado",type:"negative"}),l.visible=!e})}).onCancel(()=>{l.visible=!e})}}},T={class:"row full-width"},Y={class:"col-2 flex flex-center"},A={class:"row"},M={class:"text-h5"},R={class:"text-h6"},B=["href"],F={class:"row q-col-gutter-md"},O={class:"col-12"},G={class:"col-12"},L={class:"col-4"},z={class:"col-4"},j={key:0,class:"q-mt-sm"},H={class:"col-4"},J={class:"col-4"};function K(l,e,c,W,s,r){return d(),g(S,{class:"q-pa-md"},{default:i(()=>[t(m,null,{default:i(()=>[t(n,{class:"q-pa-none",style:{"background-color":"#b28f00"}},{default:i(()=>e[9]||(e[9]=[o("div",{class:"text-h6 text-center q-pa-none text-white"},"M\xF3dulo de Ventanas Emergentes",-1)])),_:1}),t(V),t(y,null,{default:i(()=>[o("div",T,[o("div",Y,[t(u,{onClick:e[0]||(e[0]=a=>s.dialogventanaadd=!0),color:"primary",icon:"add",label:"A\xF1adir Nueva Ventana"})])])]),_:1})]),_:1}),t(m,null,{default:i(()=>[t(n,null,{default:i(()=>[o("div",A,[(d(!0),h(E,null,C(s.popup,a=>(d(),h("div",{class:"col-12 col-sm-6 col-md-3",key:a.id},[t(m,{class:"my-card q-ma-md"},{default:i(()=>[t(n,{class:"bg-primary text-white"},{default:i(()=>[o("div",M,[e[10]||(e[10]=f("Titulo:")),o("strong",null,k(a.titulo),1)]),o("div",R,[o("strong",null,k(a.descripcion),1)])]),_:2},1024),a.img_url?(d(),g(n,{key:0},{default:i(()=>[t(x,{src:r.getPdfUrl(a.img_url),style:{"max-height":"200px"}},null,8,["src"])]),_:2},1024)):v("",!0),a.archivo_url?(d(),g(n,{key:1},{default:i(()=>[o("a",{href:r.getPdfUrl(a.archivo_url),target:"_blank",class:"text-primary"}," Ver archivo ",8,B)]),_:2},1024)):v("",!0),t(V),t(n,{align:"right"},{default:i(()=>[t(u,{flat:"",color:"negative",onClick:b=>r.Eliminar(a)},{default:i(()=>e[11]||(e[11]=[f("Eliminar")])),_:2},1032,["onClick"]),t(D,{"model-value":a.visible,"onUpdate:modelValue":b=>r.confirmarCambioEstado(a,b),label:"Visible","checked-icon":"check","unchecked-icon":"close",color:"green"},null,8,["model-value","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024)]))),128))])]),_:1})]),_:1}),t(w,{modelValue:s.dialogventanaadd,"onUpdate:modelValue":e[8]||(e[8]=a=>s.dialogventanaadd=a),persistent:""},{default:i(()=>[t(m,{style:{width:"700px"}},{default:i(()=>[t(U,{onSubmit:r.Crearventana,enctype:"multipart/form-data"},{default:i(()=>[t(n,{class:"text-h6 text-center"},{default:i(()=>[e[12]||(e[12]=f(" REGISTRAR NUEVA VENTANA EMERGENTE ")),e[13]||(e[13]=o("hr",null,null,-1)),o("div",F,[o("div",O,[t(p,{modelValue:s.docData.titulo,"onUpdate:modelValue":e[1]||(e[1]=a=>s.docData.titulo=a),label:"T\xEDtulo",outlined:"",class:"uppercase-input",required:""},null,8,["modelValue"])]),o("div",G,[t(p,{modelValue:s.docData.descripcion,"onUpdate:modelValue":e[2]||(e[2]=a=>s.docData.descripcion=a),outlined:"",class:"uppercase-input",required:"",type:"textarea",label:"Descripci\xF3n"},null,8,["modelValue"])]),o("div",L,[t(p,{label:"Fecha",outlined:"",type:"date",modelValue:s.docData.fecha,"onUpdate:modelValue":e[3]||(e[3]=a=>s.docData.fecha=a),class:"q-mt-md",readonly:""},null,8,["modelValue"])]),o("div",z,[t(p,{outlined:"",label:"Seleccionar Imagen"},{append:i(()=>[t(_,{name:"image"})]),default:i(()=>[o("input",{type:"file",accept:"image/*",onChange:e[4]||(e[4]=(...a)=>r.onImageSelected&&r.onImageSelected(...a)),class:"absolute-full",style:{opacity:"0",cursor:"pointer"},required:""},null,32)]),_:1}),s.imagePreview?(d(),h("div",j,[t(x,{src:s.imagePreview,style:{"max-height":"150px"}},null,8,["src"])])):v("",!0)]),o("div",H,[t(Q,{color:"teal",modelValue:s.archivo,"onUpdate:modelValue":e[5]||(e[5]=a=>s.archivo=a),outlined:"",dense:"",rounded:"",counter:"",label:"Subir Archivo",accept:".pdf",style:{"padding-top":"10px"}},{prepend:i(()=>[t(_,{name:"cloud_upload"})]),_:1},8,["modelValue"])]),o("div",J,[t(D,{modelValue:s.docData.visible,"onUpdate:modelValue":e[6]||(e[6]=a=>s.docData.visible=a),label:"Visible","checked-icon":"check","unchecked-icon":"close",color:"green"},null,8,["modelValue"])])])]),_:1}),t(y,{align:"right"},{default:i(()=>[t(u,{flat:"",label:"Cancelar",color:"primary",onClick:e[7]||(e[7]=a=>s.dialogventanaadd=!1)}),t(u,{flat:"",label:"Guardar",color:"negative",type:"submit"})]),_:1})]),_:1},8,["onSubmit"])]),_:1})]),_:1},8,["modelValue"])]),_:1})}var se=P(I,[["render",K]]);export{se as default};
