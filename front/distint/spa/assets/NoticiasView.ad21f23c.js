import{o as r,c as y,w as o,a,h as u,e as l,i as Q,m as V,Q as p,g,b6 as d,b7 as f,b8 as v,p as b,k as h,l as D,q as _,b9 as k,f as I,t as q}from"./index.60323709.js";import{Q as w}from"./QImg.22d5224a.js";import{Q as E}from"./QFile.62787755.js";import{Q as U}from"./QForm.16a89fc1.js";import{Q as N}from"./QPage.f120dced.js";import{d as S}from"./date.ea5ee918.js";import{_ as A}from"./plugin-vue_export-helper.21dcd24c.js";import"./QChip.a8ddf73a.js";import"./format.8ac60962.js";const{formatDate:x}=S,O={data(){return{dialogcategoryadd:!1,docData:{titulo:"",descripcion:"",fecha:x(Date.now(),"YYYY-MM-DD"),visible:!0},archivo:null,img:null,selectedImages:[],imagePreviews:[],noticias:[]}},created(){this.misnoticias()},methods:{misnoticias(){this.$api.get("misnoticias").then(i=>{this.noticias=i.data,console.log(i.data)})},Crearnoticia(){this.$q.dialog({title:"Confirmaci\xF3n",message:"\xBFEst\xE1 seguro de crear el registro?",ok:{push:!0},cancel:{push:!0,color:"negative"},persistent:!0}).onOk(()=>{const i=new FormData;i.append("titulo",this.docData.titulo),i.append("descripcion",this.docData.descripcion),i.append("fecha",this.docData.fecha),i.append("visible",this.docData.visible?1:0),this.archivo&&i.append("archivo",this.archivo),this.selectedImages.forEach((e,c)=>{i.append("imagenes[]",e)}),this.$q.loading.show(),this.$api.post("/crearnoticia",i,{headers:{"Content-Type":"multipart/form-data"}}).then(e=>{console.log(e.data),this.docData={titulo:"",descripcion:"",fecha:x(Date.now(),"YYYY-MM-DD"),visible:!0},this.archivo=null,this.selectedImages=[],this.imagePreviews=[],this.misnoticias(),this.$q.loading.hide(),this.dialogcategoryadd=!1,this.$q.notify({message:"Noticia creado Correctamente",type:"positive"})}).catch(e=>{console.error("Error al crear:",e)})})},onImagesSelected(i){const e=Array.from(i.target.files);this.selectedImages=e,this.imagePreviews=e.map(c=>URL.createObjectURL(c))},getUrl(i){return i?`http://192.168.154.233:81/storage/${i}`:""},Eliminar(i){this.$q.dialog({title:"Confirmar",message:"\xBFEst\xE1 seguro de eliminar esta noticia?",cancel:!0,persistent:!0}).onOk(()=>{this.$api.post("eliminarnoticia",{datos:i}).then(e=>{this.noticias=this.noticias.filter(c=>c.id!==i.id),this.$q.notify({message:"Noticia eliminada correctamente",type:"negative"})}).catch(e=>{this.$q.notify({message:"Error al eliminar la noticia",type:"warning"})})})},confirmarCambioEstado(i,e){this.$q.dialog({title:"Confirmar",message:"\xBFEst\xE1 seguro de cambiar el estado de visibilidad?",cancel:!0,persistent:!0}).onOk(()=>{this.$api.post("cambiarEstadoNoticia",{id:i.id,visible:e}).then(c=>{this.$q.notify({message:"Estado actualizado correctamente",type:"positive"}),i.visible=e}).catch(c=>{this.$q.notify({message:"Error al actualizar estado",type:"negative"}),i.visible=!e})}).onCancel(()=>{i.visible=!e})}}},T={class:"row full-width"},Y={class:"col-2 flex flex-center"},P={class:"text-h5"},B={class:"row items-start"},F={class:"col-12 col-md-8"},M={class:"text-h6 q-mb-md"},R={key:0,class:"q-mb-sm"},L=["href"],z={key:0,class:"col-12 col-md-4"},G={class:"row q-col-gutter-md"},j={class:"col-12"},H={class:"col-12"},J={class:"col-4"},K={class:"col-4"},W={key:0,class:"q-mt-sm row q-col-gutter-sm"},X={class:"col-4"},Z={class:"col-4"};function $(i,e,c,ee,s,n){return r(),y(N,{class:"q-pa-md"},{default:o(()=>[a(g,null,{default:o(()=>[a(u,{class:"q-pa-none",style:{"background-color":"#b28f00"}},{default:o(()=>e[9]||(e[9]=[l("div",{class:"text-h6 text-center q-pa-none text-white"},"MODULO DE NOTICIAS",-1)])),_:1}),a(Q),a(V,null,{default:o(()=>[l("div",T,[l("div",Y,[a(p,{onClick:e[0]||(e[0]=t=>s.dialogcategoryadd=!0),color:"primary",icon:"add",label:"A\xF1adir Nueva Noticia"})])])]),_:1})]),_:1}),a(g,null,{default:o(()=>[a(u,null,{default:o(()=>[l("div",null,[(r(!0),d(v,null,f(s.noticias,t=>(r(),d("div",{key:t.id,class:"q-mb-md"},[a(g,null,{default:o(()=>[a(u,{class:"bg-primary text-white"},{default:o(()=>[l("div",P,[e[10]||(e[10]=b("T\xEDtulo: ")),l("strong",null,q(t.titulo),1)])]),_:2},1024),a(u,{class:"q-pa-md"},{default:o(()=>[l("div",B,[l("div",F,[l("div",M,q(t.descripcion),1),t.archivo?(r(),d("div",R,[l("a",{href:n.getUrl(t.archivo),target:"_blank",class:"text-primary"}," Ver archivo ",8,L)])):_("",!0),l("div",null,[a(p,{flat:"",color:"negative",onClick:m=>n.Eliminar(t)},{default:o(()=>e[11]||(e[11]=[b("Eliminar")])),_:2},1032,["onClick"]),a(k,{"model-value":t.visible,"onUpdate:modelValue":m=>n.confirmarCambioEstado(t,m),label:"Visible","checked-icon":"check","unchecked-icon":"close",color:"green"},null,8,["model-value","onUpdate:modelValue"])])]),t.imagenes&&t.imagenes.length?(r(),d("div",z,[(r(!0),d(v,null,f(t.imagenes,(m,C)=>(r(),y(w,{key:C,src:n.getUrl(m.ruta),style:{width:"50%"},class:"q-mb-sm",ratio:4/3},null,8,["src"]))),128))])):_("",!0)])]),_:2},1024)]),_:2},1024)]))),128))])]),_:1})]),_:1}),a(I,{modelValue:s.dialogcategoryadd,"onUpdate:modelValue":e[8]||(e[8]=t=>s.dialogcategoryadd=t),persistent:""},{default:o(()=>[a(g,{style:{width:"700px"}},{default:o(()=>[a(U,{onSubmit:n.Crearnoticia,enctype:"multipart/form-data"},{default:o(()=>[a(u,{class:"text-h6 text-center"},{default:o(()=>[e[12]||(e[12]=b(" REGISTRAR NUEVA NOTICIA ")),e[13]||(e[13]=l("hr",null,null,-1)),l("div",G,[l("div",j,[a(h,{modelValue:s.docData.titulo,"onUpdate:modelValue":e[1]||(e[1]=t=>s.docData.titulo=t),label:"T\xEDtulo",outlined:"",class:"uppercase-input",required:""},null,8,["modelValue"])]),l("div",H,[a(h,{modelValue:s.docData.descripcion,"onUpdate:modelValue":e[2]||(e[2]=t=>s.docData.descripcion=t),outlined:"",required:"",type:"textarea",label:"Descripci\xF3n"},null,8,["modelValue"])]),l("div",J,[a(h,{label:"Fecha",outlined:"",type:"date",modelValue:s.docData.fecha,"onUpdate:modelValue":e[3]||(e[3]=t=>s.docData.fecha=t),class:"q-mt-md",readonly:""},null,8,["modelValue"])]),l("div",K,[a(h,{outlined:"",label:"Seleccionar Im\xE1genes"},{append:o(()=>[a(D,{name:"image"})]),default:o(()=>[l("input",{type:"file",accept:"image/*",multiple:"",onChange:e[4]||(e[4]=(...t)=>n.onImagesSelected&&n.onImagesSelected(...t)),class:"absolute-full",style:{opacity:"0",cursor:"pointer"}},null,32)]),_:1}),s.imagePreviews.length?(r(),d("div",W,[(r(!0),d(v,null,f(s.imagePreviews,(t,m)=>(r(),d("div",{key:m,class:"col-6"},[a(w,{src:t,style:{"max-height":"150px"}},null,8,["src"])]))),128))])):_("",!0)]),l("div",X,[a(E,{color:"teal",modelValue:s.archivo,"onUpdate:modelValue":e[5]||(e[5]=t=>s.archivo=t),outlined:"",dense:"",rounded:"",counter:"",label:"Subir Archivo",accept:".pdf",style:{"padding-top":"10px"}},{prepend:o(()=>[a(D,{name:"cloud_upload"})]),_:1},8,["modelValue"])]),l("div",Z,[a(k,{modelValue:s.docData.visible,"onUpdate:modelValue":e[6]||(e[6]=t=>s.docData.visible=t),label:"Visible","checked-icon":"check","unchecked-icon":"close",color:"green"},null,8,["modelValue"])])])]),_:1}),a(V,{align:"right"},{default:o(()=>[a(p,{flat:"",label:"Cancelar",color:"primary",onClick:e[7]||(e[7]=t=>s.dialogcategoryadd=!1)}),a(p,{flat:"",label:"Guardar",color:"negative",type:"submit"})]),_:1})]),_:1},8,["onSubmit"])]),_:1})]),_:1},8,["modelValue"])]),_:1})}var ne=A(O,[["render",$],["__scopeId","data-v-b6c2e0ae"]]);export{ne as default};
